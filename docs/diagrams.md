# Visual Diagrams

This document contains all visual diagrams for the Tendo application in easy-to-read ASCII format.

## Table of Contents

1. [Database Schema / Entity Relationship Diagram](#database-schema--entity-relationship-diagram)
2. [System Architecture Diagram](#system-architecture-diagram)
3. [Component Structure](#component-structure)
4. [Sequence Diagrams](#sequence-diagrams)

---

## Database Schema / Entity Relationship Diagram

### Current Implementation (Simplified Schema with JSON Storage)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          User                                â”‚
â”‚                         [TABLE]                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”‘ id: INTEGER PRIMARY KEY AUTOINCREMENT                    â”‚
â”‚ âš¡ email: TEXT UNIQUE NOT NULL (indexed)                    â”‚
â”‚    password: TEXT NOT NULL                                   â”‚
â”‚    user_type: TEXT NOT NULL  ("patient" | "admin")          â”‚
â”‚    first_name: TEXT NOT NULL                                 â”‚
â”‚    last_name: TEXT NOT NULL                                  â”‚
â”‚    created_at: DATETIME NOT NULL                             â”‚
â”‚                                                              â”‚
â”‚    # Patient-specific fields (NULL for admin users)         â”‚
â”‚    recent_diagnosis: TEXT NULL                               â”‚
â”‚    primary_care_physician: TEXT NULL                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ 1 admin creates many forms
                              â”‚ (logical relationship, not FK)
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Form                                â”‚
â”‚                         [TABLE]                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”‘ id: TEXT PRIMARY KEY (UUID)                              â”‚
â”‚    form_name: TEXT NOT NULL                                  â”‚
â”‚    fields: TEXT NOT NULL  (JSON Array)                       â”‚
â”‚    created_at: DATETIME NOT NULL                             â”‚
â”‚                                                              â”‚
â”‚    Example fields JSON:                                      â”‚
â”‚    [{                                                        â”‚
â”‚      "id": "field_1",                                        â”‚
â”‚      "label": "Patient Name",                                â”‚
â”‚      "type": "text",                                         â”‚
â”‚      "required": true,                                       â”‚
â”‚      "placeholder": "Enter full name",                       â”‚
â”‚      "options": []                                           â”‚
â”‚    }, ...]                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                    â”‚
           â”‚ 1:N                                â”‚ 1:N
           â”‚                                    â”‚
           â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     TranslatedForm        â”‚      â”‚      FormSubmission          â”‚
â”‚        [TABLE]            â”‚      â”‚         [TABLE]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”‘ id: INTEGER PK         â”‚      â”‚ ğŸ”‘ id: INTEGER PK            â”‚
â”‚ âš¡ form_id: TEXT (indexed)â”‚      â”‚    form_id: TEXT             â”‚
â”‚ âš¡ language_code: TEXT     â”‚      â”‚    submission_data: TEXT     â”‚
â”‚    (indexed)              â”‚      â”‚    (JSON Object)             â”‚
â”‚    translated_form_name:  â”‚      â”‚    submitted_at: DATETIME    â”‚
â”‚    TEXT NOT NULL          â”‚      â”‚                              â”‚
â”‚    translated_fields: TEXTâ”‚      â”‚    Example JSON:             â”‚
â”‚    NOT NULL (JSON Array)  â”‚      â”‚    {                         â”‚
â”‚    created_at: DATETIME   â”‚      â”‚      "field_1": "John Doe",  â”‚
â”‚                           â”‚      â”‚      "field_2": "1990-01-15" â”‚
â”‚    Composite Index:       â”‚      â”‚    }                         â”‚
â”‚    (form_id, language_    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚     code) for fast lookup â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
ğŸ”‘ = Primary Key
âš¡ = Indexed Column
FK = Foreign Key (logical, not enforced in SQLite)
```

### Design Rationale

**Why Single-Table Inheritance for Users?**

- Simpler queries (no JOINs needed)
- Both user types share most fields
- Easy to add new user types
- Faster authentication lookups

**Why JSON Field Storage?**

- Schema flexibility (add field types without migrations)
- Simpler data model (fewer tables)
- Atomic translations (entire form in one query)
- Better for document-style data

**Trade-offs:**

- âŒ Can't query individual field values efficiently
- âŒ Slightly larger storage overhead
- âœ… Much simpler codebase
- âœ… Easier to maintain and extend

---

## System Architecture Diagram

### Full Stack Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CLIENT TIER                                â”‚
â”‚                            (Port 5173 - Dev)                            â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        Web Browser                             â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  React Single Page Application (SPA)                          â”‚    â”‚
â”‚  â”‚  â”œâ”€ React Router (client-side routing)                        â”‚    â”‚
â”‚  â”‚  â”œâ”€ Context API (global state)                                â”‚    â”‚
â”‚  â”‚  â””â”€ CSS Modules (component styling)                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  Vite Development Server                       â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  - Hot Module Replacement (HMR)                               â”‚    â”‚
â”‚  â”‚  - Fast ES Module serving                                     â”‚    â”‚
â”‚  â”‚  - Development proxy for API calls                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP/JSON
                                 â”‚ CORS: Allow All (dev only)
                                 â”‚ Base URL: http://localhost:8000
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           APPLICATION TIER                              â”‚
â”‚                            (Port 8000)                                  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Uvicorn ASGI Server                        â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  - Asynchronous request handling                              â”‚    â”‚
â”‚  â”‚  - Auto-reload on code changes (dev)                          â”‚    â”‚
â”‚  â”‚  - Single worker (dev) / Multiple workers (prod)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      FastAPI Application                       â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚            Middleware Layer                         â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - CORS Middleware (allow all origins in dev)       â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - Request/Response logging                         â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚                               â”‚                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚                    API Router                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Endpoints:                                            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POST   /api/auth/login                              â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POST   /api/forms                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/forms                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/forms/latest?lang={code}                â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/forms/{form_id}                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POST   /api/submissions                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/submissions                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/users/{email}                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET    /api/test                                    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Dependencies:                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ get_session() â†’ DB Session                         â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                               â”‚                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚              Business Logic Layer                       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚       TranslationService                    â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   (services/translation_service.py)         â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Class Methods:                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ translate_form_name()                    â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ translate_form_fields()                  â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ translate_responses_to_english()         â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Private Methods:                           â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ _load_api_key()                          â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ _extract_translatable_content()          â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ _translate_batch()                       â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ _apply_translations()                    â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Configuration:                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Model: gpt-4o-mini                       â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Temperature: 0.3 (deterministic)         â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ API Key: config/api_key.txt              â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                         â”‚                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                         â”‚ Async API calls               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                         â”‚                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚      OpenAI API Client (AsyncOpenAI)       â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                             â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ chat.completions.create()                â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Medical translation prompts              â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ JSON response parsing                    â”‚       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                               â”‚                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚              Data Access Layer                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚        SQLModel ORM                      â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                          â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Models:                                 â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ User (table=True)                    â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Form (table=True)                    â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ FormSubmission (table=True)          â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ TranslatedForm (table=True)          â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                          â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Request/Response Models:                â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ LoginRequest (BaseModel)             â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ LoginResponse (BaseModel)            â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                          â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Session Management:                     â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Engine (sqlite:///database.db)       â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Session factory                       â”‚          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Dependency injection via get_session()          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ SQL Queries
                                 â”‚ (via SQLAlchemy engine)
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             DATA TIER                                   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    SQLite Database                             â”‚    â”‚
â”‚  â”‚                    (database.db)                               â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  Tables:                                                       â”‚    â”‚
â”‚  â”‚  â”œâ”€ user                                                       â”‚    â”‚
â”‚  â”‚  â”‚   â””â”€ Index: email (unique)                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€ form                                                       â”‚    â”‚
â”‚  â”‚  â”œâ”€ formsubmission                                             â”‚    â”‚
â”‚  â”‚  â””â”€ translatedform                                             â”‚    â”‚
â”‚  â”‚      â””â”€ Composite Index: (form_id, language_code)             â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  Auto-initialization:                                          â”‚    â”‚
â”‚  â”‚  â€¢ Tables created via SQLModel.metadata.create_all()          â”‚    â”‚
â”‚  â”‚  â€¢ Dummy users seeded on first startup                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXTERNAL SERVICES                               â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      OpenAI API                                â”‚    â”‚
â”‚  â”‚                  (api.openai.com)                              â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  Model: gpt-4o-mini                                           â”‚    â”‚
â”‚  â”‚  Usage: Medical form translation                              â”‚    â”‚
â”‚  â”‚  Cost: ~$0.01 per form translation                            â”‚    â”‚
â”‚  â”‚  Rate Limit: Configured per API key tier                      â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  Authentication:                                               â”‚    â”‚
â”‚  â”‚  â””â”€ API Key from backend/config/api_key.txt                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Structure

### Frontend Component Hierarchy

```
src/
â”œâ”€â”€ main.jsx (Entry point)
â”‚   â””â”€â”€ App.jsx (Root component with routing)
â”‚       â””â”€â”€ LanguageProvider (Global state)
â”‚           â”œâ”€â”€ LoginPage
â”‚           â”‚   â””â”€â”€ LoginForm
â”‚           â”‚       â””â”€â”€ Input (x2 for email/password)
â”‚           â”‚
â”‚           â”œâ”€â”€ AdminPage (Protected Route)
â”‚           â”‚   â”œâ”€â”€ Header (with language selector)
â”‚           â”‚   â”œâ”€â”€ FieldEditor (Form builder)
â”‚           â”‚   â”‚   â”œâ”€â”€ FormField (Field preview)
â”‚           â”‚   â”‚   â””â”€â”€ FieldList
â”‚           â”‚   â””â”€â”€ SuccessMessage
â”‚           â”‚
â”‚           â””â”€â”€ UserFormPage (Protected Route)
â”‚               â”œâ”€â”€ Header (with language selector)
â”‚               â”œâ”€â”€ FormField (x N for each field)
â”‚               â””â”€â”€ SuccessMessage
â”‚
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ LanguageContext.jsx
â”‚       - Provides: language, setLanguage
â”‚       - Default: "en"
â”‚       - Consumed by: Header, UserFormPage
â”‚
â””â”€â”€ components/
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ LoginForm.jsx (handles authentication)
    â”‚   â””â”€â”€ Input.jsx (reusable input with validation)
    â”‚
    â”œâ”€â”€ common/
    â”‚   â”œâ”€â”€ Header.jsx (navigation + language selector)
    â”‚   â”œâ”€â”€ ProtectedRoute.jsx (auth guard)
    â”‚   â””â”€â”€ SuccessMessage.jsx (notification)
    â”‚
    â””â”€â”€ forms/
        â”œâ”€â”€ FieldEditor.jsx (form builder UI)
        â”œâ”€â”€ FieldList.jsx (list of fields in form)
        â””â”€â”€ FormField.jsx (dynamic field renderer)
```

### Backend Module Structure

```
backend/
â”œâ”€â”€ main.py (FastAPI app + routes)
â”‚   â”œâ”€â”€ Lifespan management
â”‚   â”‚   â””â”€â”€ _initialize_dummy_users()
â”‚   â”‚
â”‚   â”œâ”€â”€ Dependency injection
â”‚   â”‚   â””â”€â”€ get_session() â†’ Session
â”‚   â”‚
â”‚   â””â”€â”€ API Routes
â”‚       â”œâ”€â”€ POST /api/auth/login
â”‚       â”œâ”€â”€ POST /api/forms
â”‚       â”œâ”€â”€ GET  /api/forms
â”‚       â”œâ”€â”€ GET  /api/forms/latest
â”‚       â”œâ”€â”€ GET  /api/forms/{form_id}
â”‚       â”œâ”€â”€ POST /api/submissions
â”‚       â”œâ”€â”€ GET  /api/submissions
â”‚       â”œâ”€â”€ GET  /api/users/{email}
â”‚       â””â”€â”€ GET  /api/test
â”‚
â”œâ”€â”€ models.py (SQLModel definitions)
â”‚   â”œâ”€â”€ User (table)
â”‚   â”œâ”€â”€ Form (table)
â”‚   â”œâ”€â”€ FormSubmission (table)
â”‚   â”œâ”€â”€ TranslatedForm (table)
â”‚   â”œâ”€â”€ LoginRequest (Pydantic)
â”‚   â””â”€â”€ LoginResponse (Pydantic)
â”‚
â”œâ”€â”€ services/
â”‚   â””â”€â”€ translation_service.py
â”‚       â””â”€â”€ TranslationService
â”‚           â”œâ”€â”€ __init__()
â”‚           â”œâ”€â”€ translate_form_name()
â”‚           â”œâ”€â”€ translate_form_fields()
â”‚           â”œâ”€â”€ translate_responses_to_english()
â”‚           â””â”€â”€ private helper methods
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ constants.py
â”‚   â”‚   â”œâ”€â”€ SUPPORTED_LANGUAGES
â”‚   â”‚   â””â”€â”€ PRE_CACHE_LANGUAGES
â”‚   â””â”€â”€ api_key.txt (gitignored)
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ conftest.py (test fixtures)
    â”œâ”€â”€ test_users.py
    â”œâ”€â”€ test_forms.py
    â”œâ”€â”€ test_submissions.py
    â””â”€â”€ test_health.py
```

---

## Sequence Diagrams

### 1. User Login Flow

```
User          Browser        FastAPI        Database
 â”‚               â”‚              â”‚              â”‚
 â”‚ Enter creds   â”‚              â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚              â”‚
 â”‚               â”‚ POST /api/   â”‚              â”‚
 â”‚               â”‚ auth/login   â”‚              â”‚
 â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
 â”‚               â”‚              â”‚ SELECT *     â”‚
 â”‚               â”‚              â”‚ FROM user    â”‚
 â”‚               â”‚              â”‚ WHERE email=?â”‚
 â”‚               â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚               â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚               â”‚              â”‚ User record  â”‚
 â”‚               â”‚              â”‚              â”‚
 â”‚               â”‚              â”‚ Verify pwd   â”‚
 â”‚               â”‚              â”‚              â”‚
 â”‚               â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚               â”‚ LoginResponseâ”‚              â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ {user_type,  â”‚              â”‚
 â”‚ Redirect      â”‚  name}       â”‚              â”‚
 â”‚               â”‚              â”‚              â”‚
```

### 2. Form Creation with Pre-Caching

```
Admin    Browser    FastAPI    TranslationSvc   OpenAI      Database
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚ Create   â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚ form     â”‚          â”‚             â”‚             â”‚            â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚ POST /apiâ”‚             â”‚             â”‚            â”‚
 â”‚          â”‚ /forms   â”‚             â”‚             â”‚            â”‚
 â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ Generate    â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ UUID        â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ INSERT form â”‚             â”‚            â”‚
 â”‚          â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ Pre-cache   â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ translationsâ”‚             â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ For lang    â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ in [es,fr,  â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚  zh...]     â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ translate   â”‚ GPT request â”‚            â”‚
 â”‚          â”‚          â”‚ form_name() â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚
 â”‚          â”‚          â”‚             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
 â”‚          â”‚          â”‚             â”‚ Translation â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ translate   â”‚ GPT request â”‚            â”‚
 â”‚          â”‚          â”‚ fields()    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚
 â”‚          â”‚          â”‚             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
 â”‚          â”‚          â”‚             â”‚ Translated  â”‚            â”‚
 â”‚          â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ fields      â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ INSERT      â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ translated  â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ form        â”‚             â”‚            â”‚
 â”‚          â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚ (Repeat for each language)               â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚             â”‚            â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Success  â”‚             â”‚             â”‚            â”‚
 â”‚          â”‚          â”‚             â”‚             â”‚            â”‚
```

### 3. Form Retrieval with Translation

```
Patient  Browser   FastAPI   TranslationSvc  OpenAI   Database
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ Change  â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ languageâ”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ to ES   â”‚          â”‚            â”‚           â”‚         â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ setState â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ lang=es  â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ GET /api â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ /forms/  â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ latest?  â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ lang=es  â”‚            â”‚           â”‚         â”‚
 â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ SELECT *   â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ FROM form  â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ ORDER BY   â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ created_at â”‚           â”‚         â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚         â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚         â”‚          â”‚ Latest formâ”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ SELECT *   â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ FROM       â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ translated â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ form WHERE â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ form_id=?  â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ AND lang=? â”‚           â”‚         â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚         â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚         â”‚          â”‚ Cached     â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ translationâ”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ IF cached: â”‚           â”‚         â”‚
 â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ return it  â”‚           â”‚         â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Spanish  â”‚            â”‚           â”‚         â”‚
 â”‚ Display â”‚ form     â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ IF NOT cached:                   â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ translate()â”‚ GPT call  â”‚         â”‚
 â”‚         â”‚          â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚         â”‚
 â”‚         â”‚          â”‚            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
 â”‚         â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Result    â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ INSERT     â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ cache      â”‚           â”‚         â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚           â”‚         â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Spanish  â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ form     â”‚            â”‚           â”‚         â”‚
```

### 4. Form Submission with Response Translation

```
Patient  Browser   FastAPI   TranslationSvc  OpenAI   Database
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ Fill    â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ form in â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ Spanish â”‚          â”‚            â”‚           â”‚         â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚ Submit  â”‚          â”‚            â”‚           â”‚         â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ POST /apiâ”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ /submis  â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ sions    â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚ {form_id,â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚  data,   â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚  lang:es}â”‚            â”‚           â”‚         â”‚
 â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ translate_ â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ responses_ â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ to_english()          â”‚         â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚           â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚ GPT call  â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚ (batch    â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚  translateâ”‚         â”‚
 â”‚         â”‚          â”‚            â”‚  all      â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚  fields)  â”‚         â”‚
 â”‚         â”‚          â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚         â”‚
 â”‚         â”‚          â”‚            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
 â”‚         â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ English   â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚ responses â”‚         â”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ INSERT     â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ submission â”‚           â”‚         â”‚
 â”‚         â”‚          â”‚ (English)  â”‚           â”‚         â”‚
 â”‚         â”‚          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
 â”‚         â”‚          â”‚            â”‚           â”‚         â”‚
 â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚           â”‚         â”‚
 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Success  â”‚            â”‚           â”‚         â”‚
 â”‚ Confirm â”‚          â”‚            â”‚           â”‚         â”‚
```

---

## Technology Stack

### Frontend Technologies

- **React 19**: Latest React with concurrent features
- **Vite**: Next-gen frontend build tool
- **React Router**: Declarative routing
- **CSS Modules**: Scoped component styling
- **Context API**: Lightweight state management

### Backend Technologies

- **FastAPI**: Modern async Python web framework
- **SQLModel**: Type-safe ORM (Pydantic + SQLAlchemy)
- **Uvicorn**: ASGI server with async support
- **OpenAI SDK**: Official Python client for GPT API
- **Python 3.13**: Latest Python features

### Database

- **SQLite**: Embedded SQL database
- **SQLModel ORM**: Auto-migration support

### External Services

- **OpenAI GPT-4o-mini**: Cost-effective language model
- **Model Cost**: ~$0.01 per form translation
- **Response Time**: 1-3 seconds per translation

---

**Last Updated**: October 3, 2025  
**Diagrams Version**: 1.0.0
